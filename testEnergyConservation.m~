%clear all;
%close all;


global param;
param = setup_params();

ya = [0, 100, 300, 0.27]';
ta = 0;
te = 60;
N = 3e4;
dt = (te-ta)/N;

T = @(t) param.Tmax;
CL = @(t) param.CLmax/9;

func = @(t,state) f_plane(t, state, T(t), CL(t));

[yres, tres] = explEuler(func, ya, ta, te, N);

dyres = (yres(:,2:end) - yres(:,1:N))/dt;
dx = dyres(1,:);
dh = dyres(2,:);
dv = dyres(3,:);

E = energyConservation([1:N], dx, dv, dh, T, D);